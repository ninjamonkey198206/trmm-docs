
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A remote monitoring and management tool">
      
      
        <meta name="author" content="amidaware">
      
      
        <link rel="canonical" href="https://docs.tacticalrmm.com/functions/api_examples/">
      
      <link rel="icon" href="../../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.3.9">
    
    
      
        <title>API Examples - Tactical RMM Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.1d29e8d0.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#api-examples" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Tactical RMM Documentation" class="md-header__button md-logo" aria-label="Tactical RMM Documentation" data-md-component="logo">
      
  <img src="../../images/onit.ico" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Tactical RMM Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API Examples
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="light" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/amidaware/tacticalrmm" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    amidaware/tacticalrmm
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Tactical RMM Documentation" class="md-nav__button md-logo" aria-label="Tactical RMM Documentation" data-md-component="logo">
      
  <img src="../../images/onit.ico" alt="logo">

    </a>
    Tactical RMM Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/amidaware/tacticalrmm" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    amidaware/tacticalrmm
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../sponsor/" class="md-nav__link">
        Sponsor
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../code_signing/" class="md-nav__link">
        Code Signing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../guide_gettingstarted/" class="md-nav__link">
        Getting Started Guide
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          RMM Server Installation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="RMM Server Installation" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          RMM Server Installation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../install_considerations/" class="md-nav__link">
        Install Considerations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../install_server/" class="md-nav__link">
        Traditional Install
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../install_docker/" class="md-nav__link">
        Docker Install
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          RMM Server Updating
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="RMM Server Updating" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          RMM Server Updating
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../update_server/" class="md-nav__link">
        Updating the RMM
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../update_docker/" class="md-nav__link">
        Updating the RMM (Docker)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Agents
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Agents" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Agents
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../install_agent/" class="md-nav__link">
        Agent Installation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../update_agents/" class="md-nav__link">
        Updating Agents
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          Functionality
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Functionality" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Functionality
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../howitallworks/" class="md-nav__link">
        How it all Works
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../alerting/" class="md-nav__link">
        Alerting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        API Access
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../automated_tasks/" class="md-nav__link">
        Automated Tasks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../automation_policies/" class="md-nav__link">
        Automation Policies
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../custom_fields/" class="md-nav__link">
        Custom Fields
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../database_maintenance/" class="md-nav__link">
        Database Maintenance
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../django_admin/" class="md-nav__link">
        Django Admin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../email_alert/" class="md-nav__link">
        Email Alerts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../keystore/" class="md-nav__link">
        Global Keystore
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../maintenance_mode/" class="md-nav__link">
        Maintenance Mode
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../permissions/" class="md-nav__link">
        Permissions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../remote_bg/" class="md-nav__link">
        Remote Background
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../settings_override/" class="md-nav__link">
        Settings Override
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../scripting/" class="md-nav__link">
        Scripting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../url_actions/" class="md-nav__link">
        URL Actions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user_ui/" class="md-nav__link">
        User Interface Preferences
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../script_variables/" class="md-nav__link">
        Reference: Script Variables
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/" class="md-nav__link">
        Examples
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../backup/" class="md-nav__link">
        Backup
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../restore/" class="md-nav__link">
        Restore
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../av/" class="md-nav__link">
        Antivirus Exclusions
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting/" class="md-nav__link">
        Troubleshooting
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../faq/" class="md-nav__link">
        FAQ
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../management_cmds/" class="md-nav__link">
        Management Commands
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../public_rsa_keys/" class="md-nav__link">
        Public RSA Keys
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../mesh_integration/" class="md-nav__link">
        MeshCentral Integration
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_17" type="checkbox" id="__nav_17" >
      
      
      
      
        <label class="md-nav__link" for="__nav_17">
          3rd Party Integrations
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="3rd Party Integrations" data-md-level="1">
        <label class="md-nav__title" for="__nav_17">
          <span class="md-nav__icon md-icon"></span>
          3rd Party Integrations
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../3rdparty_grafana/" class="md-nav__link">
        Grafana
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../3rdparty_anydesk/" class="md-nav__link">
        AnyDesk
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../3rdparty_bomgar/" class="md-nav__link">
        Bomgar
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../3rdparty_screenconnect/" class="md-nav__link">
        Connectwise Control / Screenconnect
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../3rdparty_splashtop/" class="md-nav__link">
        Splashtop
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../3rdparty_teamviewer/" class="md-nav__link">
        TeamViewer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../3rdparty_bitdefender_gravityzone/" class="md-nav__link">
        BitDefender GravityZone
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../3rdparty_bitdefender_total_security/" class="md-nav__link">
        BitDefender Total Security
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_18" type="checkbox" id="__nav_18" >
      
      
      
      
        <label class="md-nav__link" for="__nav_18">
          Unsupported Extras
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Unsupported Extras" data-md-level="1">
        <label class="md-nav__title" for="__nav_18">
          <span class="md-nav__icon md-icon"></span>
          Unsupported Extras
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../unsupported_guidelines/" class="md-nav__link">
        Unsupported Guidelines
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../unsupported_scripts/" class="md-nav__link">
        Unsupported Configs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../securing_nginx/" class="md-nav__link">
        Securing nginx
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../unsupported_proxies/" class="md-nav__link">
        Unsupported Proxies
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../unsupported_synology_docker_install/" class="md-nav__link">
        Installing in Synology docker
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../unsupported_platforms/" class="md-nav__link">
        Installing on other platforms
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../tipsntricks/" class="md-nav__link">
        Tips n' Tricks
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_20" type="checkbox" id="__nav_20" >
      
      
      
      
        <label class="md-nav__link" for="__nav_20">
          Contributing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Contributing" data-md-level="1">
        <label class="md-nav__title" for="__nav_20">
          <span class="md-nav__icon md-icon"></span>
          Contributing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/" class="md-nav__link">
        Contributing to Docs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing_community_scripts/" class="md-nav__link">
        Contributing to Community Scripts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing_using_browser/" class="md-nav__link">
        Contributing using a browser
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing_using_vscode/" class="md-nav__link">
        Contributing using VSCode
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing_using_docker/" class="md-nav__link">
        Contributing using Docker
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing_using_a_remote_server/" class="md-nav__link">
        Contributing using a Remote Server
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../security/" class="md-nav__link">
        Security
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../license/" class="md-nav__link">
        License
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#get-custom-fields" class="md-nav__link">
    Get Custom Fields
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#get-custom-fields_1" class="md-nav__link">
    Get Custom Fields
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-collector-tasks" class="md-nav__link">
    Create Collector Tasks
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#show-tasks" class="md-nav__link">
    Show Tasks
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#taskcollector-results" class="md-nav__link">
    Task/collector results
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#update-custom-fields" class="md-nav__link">
    Update Custom Fields
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#list-service-information-from-agent" class="md-nav__link">
    List service information from Agent
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#combining-scripts" class="md-nav__link">
    Combining scripts
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="api-examples">API Examples<a class="headerlink" href="#api-examples" title="Permanent link">&para;</a></h1>
<h2 id="get-custom-fields">Get Custom Fields<a class="headerlink" href="#get-custom-fields" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="nv">$TRMM_API_Base_Endpoint</span> <span class="p">=</span> <span class="nb">Read-Host</span> <span class="s2">&quot;Please provide your API domain i.e https://api.domain.com&quot;</span>
<span class="nv">$TRMM_API_Key</span> <span class="p">=</span> <span class="nb">Read-Host</span> <span class="s2">&quot;Please provide your API Key&quot;</span>

<span class="nv">$TRMM_API_CustomFields_Endpoint</span> <span class="p">=</span> <span class="nv">$TRMM_API_Base_Endpoint</span> <span class="p">+</span> <span class="s2">&quot;/core/customfields&quot;</span>

<span class="nv">$TRMM_Request_Headers</span> <span class="p">=</span> <span class="p">@{</span>

    <span class="s2">&quot;X-API-KEY&quot;</span> <span class="p">=</span> <span class="nv">$TRMM_API_Key</span>

<span class="p">}</span>

<span class="nv">$Request</span> <span class="p">=</span> <span class="nb">Invoke-RestMethod</span> <span class="nv">$TRMM_API_CustomFields_Endpoint</span> <span class="n">-Headers</span> <span class="nv">$TRMM_Request_Headers</span> <span class="n">-Method</span> <span class="n">Get</span>

<span class="nv">$TRMM_Agent_ExistingCustomFields</span> <span class="p">=</span> <span class="p">(</span><span class="nv">$Request</span> <span class="p">|</span> <span class="p">?</span> <span class="p">{</span><span class="nv">$_</span><span class="p">.</span><span class="n">model</span> <span class="o">-eq</span> <span class="s1">&#39;Agent&#39;</span><span class="p">})</span>

<span class="c"># Gets all of the Windows Features and places it in an array to parse later</span>
<span class="c"># This is to ensure that TRMM has all Windows Feature roles available as a Custom Field</span>
<span class="nv">$AllWindowsFeatures</span> <span class="p">=</span> <span class="nb">Get-WindowsFeature</span>
<span class="nv">$TRMM_Role_AllCustomFields</span> <span class="p">=</span> <span class="p">@()</span>

<span class="k">foreach</span><span class="p">(</span><span class="nv">$WindowsFeature</span> <span class="k">in</span> <span class="nv">$AllWindowsFeatures</span><span class="p">){</span>

    <span class="k">if</span><span class="p">(</span><span class="nv">$WindowsFeature</span><span class="p">.</span><span class="n">Depth</span> <span class="o">-eq</span> <span class="n">1</span><span class="p">){</span>

        <span class="nv">$PrimaryRole</span> <span class="p">=</span> <span class="nv">$WindowsFeature</span><span class="p">.</span><span class="n">DisplayName</span>

    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>

        <span class="nv">$TRMM_Role_AllCustomFields</span> <span class="p">+=</span> <span class="no">[PSCustomObject]</span><span class="p">@{</span>

            <span class="s2">&quot;Role&quot;</span> <span class="p">=</span> <span class="nv">$PrimaryRole</span>
            <span class="s2">&quot;Value&quot;</span> <span class="p">=</span> <span class="nv">$WindowsFeature</span><span class="p">.</span><span class="n">DisplayName</span>

        <span class="p">}</span>

    <span class="p">}</span>

<span class="p">}</span>

<span class="nv">$Unique_Roles</span> <span class="p">=</span> <span class="nv">$TRMM_Role_AllCustomFields</span> <span class="p">|</span> <span class="nb">Select </span><span class="n">-Unique</span> <span class="n">Role</span>
<span class="c">#Loop through each WindowsFeature</span>
<span class="k">foreach</span><span class="p">(</span><span class="nv">$WindowsFeature</span> <span class="k">in</span> <span class="nv">$Unique_Roles</span><span class="p">){</span>

    <span class="k">if</span><span class="p">(</span><span class="nv">$TRMM_Agent_ExistingCustomFields</span><span class="p">.</span><span class="n">Name</span> <span class="o">-like</span> <span class="s2">&quot;*</span><span class="p">$(</span><span class="nv">$WindowsFeature</span><span class="p">.</span><span class="n">Role</span><span class="p">)</span><span class="s2">*&quot;</span><span class="p">){</span>

        <span class="c"># Need to check if it also contains the value</span>

    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>

        <span class="c"># Check to see if the Role is an Array or an Object</span>
        <span class="c"># Convert to Array otherwise</span>

        <span class="k">if</span><span class="p">(((</span><span class="nv">$TRMM_Role_AllCustomFields</span> <span class="p">|</span> <span class="p">?</span> <span class="p">{</span><span class="nv">$_</span><span class="p">.</span><span class="n">Role</span> <span class="o">-eq</span> <span class="nv">$WindowsFeature</span><span class="p">.</span><span class="n">Role</span><span class="p">}).</span><span class="n">Value</span><span class="p">)</span> <span class="o">-isnot</span> <span class="no">[array]</span><span class="p">){</span>

            <span class="nv">$CustomFieldOptions</span> <span class="p">=</span> <span class="p">@((</span><span class="nv">$TRMM_Role_AllCustomFields</span> <span class="p">|</span> <span class="p">?</span> <span class="p">{</span><span class="nv">$_</span><span class="p">.</span><span class="n">Role</span> <span class="o">-eq</span> <span class="nv">$WindowsFeature</span><span class="p">.</span><span class="n">Role</span><span class="p">}).</span><span class="n">Value</span><span class="p">)</span>

        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>

            <span class="nv">$CustomFieldOptions</span> <span class="p">=</span> <span class="p">(</span><span class="nv">$TRMM_Role_AllCustomFields</span> <span class="p">|</span> <span class="p">?</span> <span class="p">{</span><span class="nv">$_</span><span class="p">.</span><span class="n">Role</span> <span class="o">-eq</span> <span class="nv">$WindowsFeature</span><span class="p">.</span><span class="n">Role</span><span class="p">}).</span><span class="n">Value</span>

        <span class="p">}</span>

        <span class="c"># Create the Custom Field body</span>
        <span class="nv">$CustomFieldData</span> <span class="p">=</span> <span class="p">@{</span>

            <span class="n">model</span> <span class="p">=</span> <span class="s2">&quot;agent&quot;</span>
            <span class="n">name</span> <span class="p">=</span> <span class="s2">&quot;Server Role - &quot;</span> <span class="p">+</span> <span class="nv">$WindowsFeature</span><span class="p">.</span><span class="n">Role</span>
            <span class="nb">type </span><span class="p">=</span> <span class="s2">&quot;multiple&quot;</span>
            <span class="n">options</span> <span class="p">=</span> <span class="nv">$CustomFieldOptions</span>

        <span class="p">}</span>

        <span class="nv">$CreateCustomField</span> <span class="p">=</span> <span class="nb">Invoke-RestMethod</span> <span class="nv">$TRMM_API_CustomFields_Endpoint</span> <span class="n">-Headers</span> <span class="nv">$TRMM_Request_Headers</span> <span class="n">-Method</span> <span class="n">Post</span> <span class="n">-Body</span> <span class="p">(</span><span class="nv">$CustomFieldData</span> <span class="p">|</span> <span class="nb">ConvertTo-Json</span><span class="p">)</span> <span class="n">-ContentType</span> <span class="s2">&quot;application/json&quot;</span>

    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="get-custom-fields_1">Get Custom Fields<a class="headerlink" href="#get-custom-fields_1" title="Permanent link">&para;</a></h2>
<p><a href="https://discord.com/channels/736478043522072608/888474369544847430/1004184193078669522">https://discord.com/channels/736478043522072608/888474369544847430/1004184193078669522</a></p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="n">API</span> <span class="o">=</span> <span class="s2">&quot;https://api.example.com&quot;</span>
<span class="n">HEADERS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Content-Type&quot;</span><span class="p">:</span> <span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
    <span class="s2">&quot;X-API-KEY&quot;</span><span class="p">:</span> <span class="s2">&quot;changeme&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">payload</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;custom_fields&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;string_value&quot;</span><span class="p">:</span> <span class="s2">&quot;66666&quot;</span><span class="p">,</span> <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}]}</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">put</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">API</span><span class="si">}</span><span class="s2">/agents/IcAhWvOHlADwjuYmndAkjbJuhSdWvWjtvYcYjCZk/&quot;</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">payload</span><span class="p">),</span>
    <span class="n">headers</span><span class="o">=</span><span class="n">HEADERS</span><span class="p">,</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
</code></pre></div>
<h2 id="create-collector-tasks">Create Collector Tasks<a class="headerlink" href="#create-collector-tasks" title="Permanent link">&para;</a></h2>
<p><a href="https://discord.com/channels/736478043522072608/888474369544847430/1004383584070676610">https://discord.com/channels/736478043522072608/888474369544847430/1004383584070676610</a></p>
<div class="highlight"><pre><span></span><code><span class="c"># Query the TRMM API with PowerShell</span>

<span class="c"># Add this to dotenv.ps1</span>
<span class="c">#$TRMM_API_KEY = &quot;&quot;</span>
<span class="c">#$TRMM_API_DOMAIN = &quot;&quot;</span>
<span class="p">.</span> <span class="p">.\</span><span class="n">dotenv</span><span class="p">.</span><span class="n">ps1</span>

<span class="k">function</span> <span class="n">GetURL</span> <span class="p">{</span>
    <span class="k">param</span> <span class="p">(</span>
        <span class="no">[string]</span> <span class="nv">$Path</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="s2">&quot;https://${TRMM_API_DOMAIN}/${Path}/&quot;</span>
<span class="p">}</span>

<span class="nv">$Headers</span> <span class="p">=</span> <span class="p">@{</span>
    <span class="s1">&#39;X-API-KEY&#39;</span> <span class="p">=</span> <span class="nv">$TRMM_API_KEY</span>
<span class="p">}</span>

<span class="nv">$Collector</span> <span class="p">=</span> <span class="no">[PSCustomObject]</span><span class="p">@{</span>
    <span class="n">policy</span> <span class="p">=</span> <span class="n">1</span>
    <span class="n">actions</span> <span class="p">=</span> <span class="p">@(@{</span>
        <span class="n">name</span> <span class="p">=</span> <span class="s2">&quot;Collector - Location - City and State&quot;</span>
        <span class="nb">type </span><span class="p">=</span> <span class="s2">&quot;script&quot;</span>
        <span class="n">script</span> <span class="p">=</span> <span class="n">121</span>
        <span class="n">timeout</span> <span class="p">=</span> <span class="n">90</span>
        <span class="n">script_args</span> <span class="p">=</span> <span class="p">@()</span>
    <span class="p">})</span>
    <span class="n">assigned_check</span> <span class="p">=</span> <span class="nv">$null</span>
    <span class="n">custom_field</span> <span class="p">=</span> <span class="n">14</span>
    <span class="n">name</span> <span class="p">=</span> <span class="s2">&quot;Get city and state from API&quot;</span>
    <span class="c"># expire_date = $null</span>
    <span class="n">run_time_date</span> <span class="p">=</span> <span class="s2">&quot;2022-08-02T08:00:00Z&quot;</span>
    <span class="c"># run_time_bit_weekdays = $null</span>
    <span class="n">weekly_interval</span> <span class="p">=</span> <span class="n">1</span>
    <span class="n">daily_interval</span> <span class="p">=</span> <span class="n">1</span>
    <span class="c"># monthly_months_of_year = $null</span>
    <span class="c"># monthly_days_of_month = $null</span>
    <span class="c"># monthly_weeks_of_month = $null</span>
    <span class="c"># task_instance_policy = 0</span>
    <span class="c"># task_repetition_interval = $null</span>
    <span class="c"># task_repetition_duration = $null</span>
    <span class="c"># stop_task_at_duration_end = $false</span>
    <span class="c"># random_task_delay = $null</span>
    <span class="c"># remove_if_not_scheduled = $false</span>
    <span class="n">run_asap_after_missed</span> <span class="p">=</span> <span class="nv">$true</span>
    <span class="n">task_type</span> <span class="p">=</span> <span class="s2">&quot;daily&quot;</span>
    <span class="n">alert_severity</span> <span class="p">=</span> <span class="s2">&quot;info&quot;</span>
    <span class="c"># collector_all_output = $false</span>
    <span class="c"># continue_on_error = $false</span>
<span class="p">}</span>

<span class="nv">$Tasks_Endpoint</span> <span class="p">=</span> <span class="n">GetURL</span><span class="p">(</span><span class="s2">&quot;tasks&quot;</span><span class="p">)</span>
<span class="nv">$Payload</span> <span class="p">=</span> <span class="nv">$Collector</span> <span class="p">|</span> <span class="nb">ConvertTo-Json</span>
<span class="nv">$Response</span> <span class="p">=</span> <span class="nb">Invoke-RestMethod</span> <span class="nv">$Tasks_Endpoint</span> <span class="n">-Headers</span> <span class="nv">$Headers</span> <span class="n">-ContentType</span> <span class="s2">&quot;application/json&quot;</span> <span class="n">-Method</span> <span class="s2">&quot;Post&quot;</span> <span class="n">-Body</span> <span class="nv">$Payload</span>
<span class="k">if</span> <span class="p">(!</span> <span class="p">$?)</span> <span class="p">{</span>
    <span class="nb">Write-Output</span> <span class="s2">&quot;Failed to submit request: </span><span class="p">$(</span><span class="nv">$error</span><span class="p">[</span><span class="n">0</span><span class="p">].</span><span class="n">ToString</span><span class="p">()</span> <span class="p">)</span><span class="s2">&quot;</span>
    <span class="nb">Write-Output</span> <span class="s2">&quot;Stacktrace: </span><span class="p">$(</span><span class="nv">$error</span><span class="p">[</span><span class="n">0</span><span class="p">].</span><span class="n">Exception</span><span class="p">.</span><span class="n">ToString</span><span class="p">()</span> <span class="p">)</span><span class="s2">&quot;</span>
    <span class="n">Exit</span><span class="p">(</span><span class="n">1</span><span class="p">)</span>
<span class="p">}</span>
<span class="nv">$Response</span> <span class="p">|</span> <span class="nb">ConvertTo-Json</span>
</code></pre></div>
<h2 id="show-tasks">Show Tasks<a class="headerlink" href="#show-tasks" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="c"># Query the TRMM API with PowerShell</span>
<span class="p">.</span> <span class="p">.\</span><span class="n">dotenv</span><span class="p">.</span><span class="n">ps1</span>

<span class="nv">$Tasks_Endpoint</span> <span class="p">=</span> <span class="n">GetURL</span><span class="p">(</span><span class="s2">&quot;tasks&quot;</span><span class="p">)</span>
<span class="nv">$Response</span> <span class="p">=</span> <span class="nb">Invoke-RestMethod</span> <span class="nv">$Tasks_Endpoint</span> <span class="n">-Headers</span> <span class="nv">$Headers</span> <span class="n">-ContentType</span> <span class="s2">&quot;application/json&quot;</span> <span class="n">-Method</span> <span class="s2">&quot;Get&quot;</span>
<span class="c"># $Response | ConvertTo-Json</span>
<span class="nv">$Response</span><span class="p">.</span><span class="k">foreach</span><span class="p">({</span> <span class="nv">$_</span> <span class="p">})</span> <span class="p">|</span> <span class="nb">Select-Object</span> <span class="n">ID</span><span class="p">,</span> <span class="n">Policy</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">Custom_Field</span> <span class="p">|</span> <span class="nb">Format-Table</span>
</code></pre></div>
<h2 id="taskcollector-results">Task/collector results<a class="headerlink" href="#taskcollector-results" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="c"># Query the TRMM API with PowerShell</span>
<span class="p">.</span> <span class="p">.\</span><span class="n">dotenv</span><span class="p">.</span><span class="n">ps1</span>

<span class="nv">$Agents_Endpoint</span> <span class="p">=</span> <span class="n">GetURL</span><span class="p">(</span><span class="s2">&quot;agents&quot;</span><span class="p">)</span>
<span class="nv">$Agents</span> <span class="p">=</span> <span class="nb">Invoke-RestMethod</span> <span class="nv">$Agents_Endpoint</span> <span class="n">-Headers</span> <span class="nv">$Headers</span> <span class="n">-ContentType</span> <span class="s2">&quot;application/json&quot;</span> <span class="n">-Method</span> <span class="s2">&quot;Get&quot;</span>
<span class="c"># $Agents | ConvertTo-Json</span>
<span class="c"># $Agents.foreach({ $_ }) | Select-Object Agent_ID, Hostname, Site_Name, Client_Name, Monitoring_Type | Format-Table</span>
<span class="nv">$Agent_ID</span> <span class="p">=</span> <span class="s2">&quot;AGENT ID FROM TABLE&quot;</span>

<span class="nv">$Agents</span><span class="p">.</span><span class="k">foreach</span><span class="p">({</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$_</span><span class="p">.</span><span class="n">Agent_ID</span> <span class="o">-ne</span> <span class="nv">$Agent_ID</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span>
    <span class="p">}</span>
    <span class="nv">$Fields_Endpoint</span> <span class="p">=</span> <span class="n">GetURL</span><span class="p">(</span><span class="s2">&quot;agents/</span><span class="p">$(</span><span class="nv">$_</span><span class="p">.</span><span class="n">Agent_ID</span><span class="p">)</span><span class="s2">/tasks&quot;</span><span class="p">)</span>
    <span class="nv">$Fields</span> <span class="p">=</span> <span class="nb">Invoke-RestMethod</span> <span class="nv">$Fields_Endpoint</span> <span class="n">-Headers</span> <span class="nv">$Headers</span> <span class="n">-ContentType</span> <span class="s2">&quot;application/json&quot;</span> <span class="n">-Method</span> <span class="s2">&quot;Get&quot;</span>
    <span class="c"># $Fields | ConvertTo-Json</span>
    <span class="nv">$Fields</span><span class="p">.</span><span class="k">foreach</span><span class="p">({</span> <span class="nv">$_</span> <span class="p">})</span> <span class="p">|</span> <span class="nb">Select-Object</span> <span class="n">ID</span><span class="p">,</span> <span class="n">Check_Name</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">Actions</span><span class="p">,</span> <span class="n">Task_Result</span> <span class="p">|</span> <span class="nb">Format-Table</span>
<span class="p">})</span>
</code></pre></div>
<h2 id="update-custom-fields">Update Custom Fields<a class="headerlink" href="#update-custom-fields" title="Permanent link">&para;</a></h2>
<p><a href="https://discord.com/channels/736478043522072608/888474369544847430/1004422340815360111">https://discord.com/channels/736478043522072608/888474369544847430/1004422340815360111</a></p>
<p>This will update the custom fields for an agent. The field value come from the custom fields two posts above. Other fields that exist will not be updated. If you want to update only 1 custom field, use only 1 entry in the array.</p>
<div class="highlight"><pre><span></span><code><span class="c"># Query the TRMM API with PowerShell</span>
<span class="p">.</span> <span class="p">.\</span><span class="n">dotenv</span><span class="p">.</span><span class="n">ps1</span>

<span class="nv">$Agent_ID</span> <span class="p">=</span> <span class="s2">&quot;AGENT ID GOES HERE&quot;</span>
<span class="nv">$Endpoint</span> <span class="p">=</span> <span class="n">GetURL</span><span class="p">(</span><span class="s2">&quot;agents/</span><span class="p">$(</span><span class="nv">$Agent_ID</span><span class="p">)</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nv">$Custom_Fields</span> <span class="p">=</span> <span class="no">[PSCustomObject]</span><span class="p">@{</span>
    <span class="n">custom_fields</span> <span class="p">=</span> <span class="p">@(</span>
        <span class="p">@{</span>
            <span class="n">field</span> <span class="p">=</span> <span class="n">13</span>
            <span class="n">string_value</span> <span class="p">=</span> <span class="s2">&quot;Value updated from the API&quot;</span>
        <span class="p">},</span>
        <span class="p">@{</span>
            <span class="n">field</span> <span class="p">=</span> <span class="n">14</span>
            <span class="n">string_value</span> <span class="p">=</span> <span class="s2">&quot;Another value from the API&quot;</span>
        <span class="p">}</span>
    <span class="p">)</span>
<span class="p">}</span>

<span class="nv">$Payload</span> <span class="p">=</span> <span class="nv">$Custom_Fields</span> <span class="p">|</span> <span class="nb">ConvertTo-Json</span>
<span class="nv">$Response</span> <span class="p">=</span> <span class="nb">Invoke-RestMethod</span> <span class="nv">$Endpoint</span> <span class="n">-Headers</span> <span class="nv">$Headers</span> <span class="n">-ContentType</span> <span class="s2">&quot;application/json&quot;</span> <span class="n">-Method</span> <span class="n">Put</span> <span class="n">-Body</span> <span class="nv">$Payload</span>
<span class="k">if</span> <span class="p">(!</span> <span class="p">$?)</span> <span class="p">{</span>
    <span class="nb">Write-Output</span> <span class="s2">&quot;Failed to submit request: </span><span class="p">$(</span><span class="nv">$error</span><span class="p">[</span><span class="n">0</span><span class="p">].</span><span class="n">ToString</span><span class="p">()</span> <span class="p">)</span><span class="s2">&quot;</span>
    <span class="nb">Write-Output</span> <span class="s2">&quot;Stacktrace: </span><span class="p">$(</span><span class="nv">$error</span><span class="p">[</span><span class="n">0</span><span class="p">].</span><span class="n">Exception</span><span class="p">.</span><span class="n">ToString</span><span class="p">()</span> <span class="p">)</span><span class="s2">&quot;</span>
    <span class="n">Exit</span><span class="p">(</span><span class="n">1</span><span class="p">)</span>
<span class="p">}</span>
<span class="nv">$Response</span> <span class="p">|</span> <span class="nb">ConvertTo-Json</span>
</code></pre></div>
<h2 id="list-service-information-from-agent">List service information from Agent<a class="headerlink" href="#list-service-information-from-agent" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="c"># Query the TRMM API with PowerShell</span>
<span class="p">.</span> <span class="p">.\</span><span class="n">dotenv</span><span class="p">.</span><span class="n">ps1</span>

<span class="nv">$Payload</span> <span class="p">=</span> <span class="no">[PSCustomObject]</span><span class="p">@{</span>
    <span class="n">code</span> <span class="p">=</span> <span class="no">[string]</span><span class="p">(</span><span class="nb">Get-Content</span> <span class="n">-Path</span> <span class="p">.\</span><span class="n">TRMM-Run-Cmd-Remote</span><span class="p">.</span><span class="n">ps1</span> <span class="n">-Raw</span> <span class="n">-Encoding</span> <span class="n">UTF8</span><span class="p">)</span>
    <span class="n">timeout</span> <span class="p">=</span> <span class="n">90</span>
    <span class="n">args</span> <span class="p">=</span> <span class="p">@()</span>
    <span class="n">shell</span> <span class="p">=</span> <span class="s2">&quot;powershell&quot;</span>
<span class="p">}</span>

<span class="nv">$Agent_ID</span> <span class="p">=</span> <span class="s2">&quot;ENTER AGENT ID HERE&quot;</span>
<span class="nv">$Rest_Params</span> <span class="p">=</span> <span class="p">@{</span>
    <span class="n">Uri</span> <span class="p">=</span> <span class="n">GetURL</span><span class="p">(</span><span class="s2">&quot;scripts/${Agent_ID}/test&quot;</span><span class="p">)</span>
    <span class="n">Headers</span> <span class="p">=</span> <span class="nv">$Headers</span>
    <span class="n">ContentType</span> <span class="p">=</span> <span class="s2">&quot;application/json&quot;</span>
    <span class="n">Method</span> <span class="p">=</span> <span class="s2">&quot;POST&quot;</span>
    <span class="n">Body</span> <span class="p">=</span> <span class="nv">$Payload</span> <span class="p">|</span> <span class="nb">ConvertTo-Json</span>
<span class="p">}</span>
<span class="c"># Write-Output $Rest_Params[&quot;Body&quot;]</span>

<span class="c"># Prefer to handle the error ourselves rather than fill the screen with red text.</span>
<span class="nv">$ErrorActionPreference</span> <span class="p">=</span> <span class="s1">&#39;SilentlyContinue&#39;</span>

<span class="nv">$Response</span> <span class="p">=</span> <span class="nb">Invoke-RestMethod</span> <span class="nv">@Rest_Params</span>
<span class="k">if</span> <span class="p">(!</span> <span class="p">$?)</span> <span class="p">{</span>
    <span class="nb">Write-Output</span> <span class="s2">&quot;Failed to submit request: </span><span class="p">$(</span><span class="nv">$error</span><span class="p">[</span><span class="n">0</span><span class="p">].</span><span class="n">ToString</span><span class="p">()</span> <span class="p">)</span><span class="s2">&quot;</span>
    <span class="nb">Write-Output</span> <span class="s2">&quot;Stacktrace: </span><span class="p">$(</span><span class="nv">$error</span><span class="p">[</span><span class="n">0</span><span class="p">].</span><span class="n">Exception</span><span class="p">.</span><span class="n">ToString</span><span class="p">()</span> <span class="p">)</span><span class="s2">&quot;</span>
    <span class="n">Exit</span><span class="p">(</span><span class="n">1</span><span class="p">)</span>
<span class="p">}</span>
<span class="c"># $Response | ConvertTo-Json</span>
<span class="nv">$Services</span> <span class="p">=</span> <span class="no">[System.Text.Encoding]</span><span class="p">::</span><span class="n">UTF8</span><span class="p">.</span><span class="n">GetString</span><span class="p">(</span><span class="no">[System.Convert]</span><span class="p">::</span><span class="n">FromBase64String</span><span class="p">(</span><span class="nv">$Response</span><span class="p">))</span>
<span class="nb">ConvertFrom-Json</span> <span class="nv">$Services</span>
</code></pre></div>
<h2 id="combining-scripts">Combining scripts<a class="headerlink" href="#combining-scripts" title="Permanent link">&para;</a></h2>
<p>This will iterate over all agents, filter out non-windows and offline agents, run the PowerShell above to the first 5 services that are running, and compile the information in a Servers array. </p>
<div class="highlight"><pre><span></span><code><span class="c"># Query the TRMM API with PowerShell</span>
<span class="p">.</span> <span class="p">.\</span><span class="n">dotenv</span><span class="p">.</span><span class="n">ps1</span>

<span class="c"># Default parameters. Body is missing because GET does not include the body.</span>
<span class="nv">$Rest_Params</span> <span class="p">=</span> <span class="p">@{</span>
    <span class="n">Uri</span> <span class="p">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">Headers</span> <span class="p">=</span> <span class="nv">$Headers</span>
    <span class="n">ContentType</span> <span class="p">=</span> <span class="s2">&quot;application/json&quot;</span>
    <span class="n">Method</span> <span class="p">=</span> <span class="s2">&quot;GET&quot;</span>
<span class="p">}</span>

<span class="c"># Prefer to handle the error ourselves rather than fill the screen with red text.</span>
<span class="nv">$ErrorActionPreference</span> <span class="p">=</span> <span class="s1">&#39;SilentlyContinue&#39;</span>

<span class="nv">$Rest_Params</span><span class="p">[</span><span class="s2">&quot;Uri&quot;</span><span class="p">]</span> <span class="p">=</span> <span class="n">GetURL</span><span class="p">(</span><span class="s2">&quot;agents&quot;</span><span class="p">)</span>
<span class="nv">$Agents</span> <span class="p">=</span> <span class="nb">Invoke-RestMethod</span> <span class="nv">@Rest_Params</span>
<span class="k">if</span> <span class="p">(!</span> <span class="p">$?)</span> <span class="p">{</span>
    <span class="nb">Write-Output</span> <span class="s2">&quot;Failed to get list of agents from API: </span><span class="p">$(</span><span class="nv">$error</span><span class="p">[</span><span class="n">0</span><span class="p">].</span><span class="n">ToString</span><span class="p">()</span> <span class="p">)</span><span class="s2">&quot;</span>
    <span class="nb">Write-Output</span> <span class="s2">&quot;Stacktrace: </span><span class="p">$(</span><span class="nv">$error</span><span class="p">[</span><span class="n">0</span><span class="p">].</span><span class="n">Exception</span><span class="p">.</span><span class="n">ToString</span><span class="p">()</span> <span class="p">)</span><span class="s2">&quot;</span>
    <span class="n">Exit</span><span class="p">(</span><span class="n">1</span><span class="p">)</span>
<span class="p">}</span>

<span class="c"># Remote command to run.</span>
<span class="nv">$Payload</span> <span class="p">=</span> <span class="no">[PSCustomObject]</span><span class="p">@{</span>
    <span class="c"># Without the type casting to [string], this was returning properties relating to Get-Content.</span>
    <span class="n">code</span> <span class="p">=</span> <span class="no">[string]</span><span class="p">(</span><span class="nb">Get-Content</span> <span class="n">-Path</span> <span class="p">.\</span><span class="n">TRMM-Run-Cmd-Remote</span><span class="p">.</span><span class="n">ps1</span> <span class="n">-Raw</span> <span class="n">-Encoding</span> <span class="n">UTF8</span><span class="p">)</span>
    <span class="n">timeout</span> <span class="p">=</span> <span class="n">90</span>
    <span class="n">args</span> <span class="p">=</span> <span class="p">@()</span>
    <span class="n">shell</span> <span class="p">=</span> <span class="s2">&quot;powershell&quot;</span>
<span class="p">}</span>

<span class="nv">$Rest_Params</span><span class="p">[</span><span class="s2">&quot;Body&quot;</span><span class="p">]</span> <span class="p">=</span> <span class="no">[string]</span><span class="p">(</span><span class="nv">$Payload</span> <span class="p">|</span> <span class="nb">ConvertTo-Json</span><span class="p">)</span>
<span class="nv">$Rest_Params</span><span class="p">[</span><span class="s2">&quot;Method&quot;</span><span class="p">]</span> <span class="p">=</span> <span class="s2">&quot;POST&quot;</span>
<span class="nv">$Servers</span> <span class="p">=</span> <span class="p">@()</span>
<span class="k">foreach</span><span class="p">(</span><span class="nv">$Agent</span> <span class="k">in</span> <span class="nv">$Agents</span><span class="p">)</span> <span class="p">{</span>
    <span class="c"># Build this object to match your needs.</span>
    <span class="nv">$Server</span> <span class="p">=</span> <span class="no">[PSCustomObject]</span><span class="p">@{</span>
        <span class="n">Agent_ID</span> <span class="p">=</span> <span class="nv">$Agent</span><span class="p">.</span><span class="n">agent_id</span>
        <span class="c"># Services = &quot;Error / Unavailable&quot;</span>
        <span class="n">Service_Name</span> <span class="p">=</span> <span class="s2">&quot;N/A&quot;</span>
        <span class="n">Service_Status</span> <span class="p">=</span> <span class="s2">&quot;N/A&quot;</span>
        <span class="n">Service_DisplayName</span> <span class="p">=</span> <span class="s2">&quot;N/A&quot;</span>
        <span class="n">Hostname</span> <span class="p">=</span> <span class="nv">$Agent</span><span class="p">.</span><span class="n">hostname</span>
        <span class="n">Platform</span> <span class="p">=</span> <span class="nv">$Agent</span><span class="p">.</span><span class="n">plat</span>
        <span class="n">Status</span> <span class="p">=</span> <span class="nv">$Agent</span><span class="p">.</span><span class="n">status</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="nv">$Agent</span><span class="p">.</span><span class="n">plat</span> <span class="o">-ne</span> <span class="s2">&quot;windows&quot;</span> <span class="o">-or</span> <span class="nv">$Agent</span><span class="p">.</span><span class="n">status</span> <span class="o">-ne</span> <span class="s2">&quot;online&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="c"># Only process online Windows agents. Add other checks as necessary.</span>
        <span class="c"># Uncomment this if you want to include filtered servers in the output.</span>
        <span class="c"># $Servers += $Server.PSObject.Copy()</span>
        <span class="k">continue</span>
    <span class="p">}</span>

    <span class="nv">$Rest_Params</span><span class="p">[</span><span class="s2">&quot;Uri&quot;</span><span class="p">]</span> <span class="p">=</span> <span class="n">GetURL</span><span class="p">(</span><span class="s2">&quot;scripts/</span><span class="p">$(</span><span class="nv">$Agent</span><span class="p">.</span><span class="n">Agent_ID</span><span class="p">)</span><span class="s2">/test&quot;</span><span class="p">)</span>
    <span class="nv">$Response</span> <span class="p">=</span> <span class="nb">Invoke-RestMethod</span> <span class="nv">@Rest_Params</span>
    <span class="k">if</span> <span class="p">(!</span> <span class="p">$?)</span> <span class="p">{</span>
        <span class="nv">$Servers</span> <span class="p">+=</span> <span class="nv">$Server</span><span class="p">.</span><span class="n">PSObject</span><span class="p">.</span><span class="n">Copy</span><span class="p">()</span>
        <span class="k">continue</span>
    <span class="p">}</span>

    <span class="c"># Create a new server object for every item returned from the remote agent (Services in this case).</span>
    <span class="nv">$Services</span> <span class="p">=</span> <span class="nb">ConvertFrom-Json</span> <span class="p">(</span><span class="no">[System.Text.Encoding]</span><span class="p">::</span><span class="n">UTF8</span><span class="p">.</span><span class="n">GetString</span><span class="p">(</span><span class="no">[System.Convert]</span><span class="p">::</span><span class="n">FromBase64String</span><span class="p">(</span><span class="nv">$Response</span><span class="p">)))</span>
    <span class="k">foreach</span><span class="p">(</span><span class="nv">$Service</span> <span class="k">in</span> <span class="nv">$Services</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$Server</span><span class="p">.</span><span class="n">Service_Name</span> <span class="p">=</span> <span class="nv">$Service</span><span class="p">.</span><span class="n">Name</span>
        <span class="nv">$Server</span><span class="p">.</span><span class="n">Service_Status</span> <span class="p">=</span> <span class="nv">$Service</span><span class="p">.</span><span class="n">Status</span>
        <span class="nv">$Server</span><span class="p">.</span><span class="n">Service_DisplayName</span> <span class="p">=</span> <span class="nv">$Service</span><span class="p">.</span><span class="n">DisplayName</span>
        <span class="nv">$Servers</span> <span class="p">+=</span> <span class="nv">$Server</span><span class="p">.</span><span class="n">PSObject</span><span class="p">.</span><span class="n">Copy</span><span class="p">()</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nv">$Servers</span> <span class="p">|</span> <span class="nb">Format-Table</span> <span class="n">Agent_ID</span><span class="p">,</span> <span class="n">Hostname</span><span class="p">,</span> <span class="n">Status</span><span class="p">,</span> <span class="n">Service_Name</span><span class="p">,</span> <span class="n">Service_Status</span><span class="p">,</span> <span class="n">Service_DisplayName</span>
<span class="c"># $Servers</span>
</code></pre></div>

              
            </article>
            
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
      
      
    
    <a href="https://github.com/amidaware/tacticalrmm" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.6c7ad80a.min.js"></script>
      
    
  </body>
</html>